amends "pkl/velocity.pkl"
import "pkl/prebuilts/git.pkl"

tests {
    new {
        name = "Golang tests"
        commands {
            git.clone
            new ShellCommand {
                command = "go test ./..."
            }
        }
    }
}

runtimes {
    new DockerRuntime {
        name = "golang"
        image = "golang:1.14"
    }
}

workflows {
    new Workflow {
        name = "Velocity"
        groups {
            new WorkflowGroup {
                name = "Golang tests"
                runtimes {
                    "golang"
                    // "python" // Uncomment to get invalid runtime error
                }
                tests {
                    "Golang tests"
                    // "non" // uncomment to get invalid test error
                }
            }
        }
    }
}
